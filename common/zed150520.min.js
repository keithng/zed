function zLayout(t,e){var n=this;n.anchor={x:0,y:0},n.x=0,n.y=0,n.padding=0,n.width=0,n.innerWidth=0,n.height=0,n.innerHeight=0,n.parent=e,n.set(t),n.innerWidth||(n.autoWidth=!0),n.innerHeight||(n.autoHeight=!0)}function zDataCube(t,e){var n=this;n.parsePos=function(t){if(null!=t&&null!=t.d)return{d:t.d,p:null!=t.p?t.p:za.isArray(t.s)?t.s[t.d]:null};throw"zDataCube.parsePos(): "+zt.asString(t)+" is invalid. (No dimension defined.)"},n.parseSpace=function(t){var e=t.s||t;if(za.isArray(e))return{s:e.slice()};if("string"==typeof e){if("all"==e||"mask"==e||"null"==e)return{s:za.fill(e,n.dLen)};throw"zDataCube.parseSpace(): "+zt.asString(t)+" is invalid. (Only 'all'/'mask'/'null' are valid strings shortcuts for spaces.)"}var r=n.parsePos(t);if(r)return e=za.fill("mask",n.dLen),e[r.d]=r.p,{s:e};throw"zDataCube.parseSpace(): "+zt.asString(t)+" is invalid. (Reason unknown.)"},n.asPos=function(t){return t=n.parsePos(t),"all"==t.p?za.fill(0,n.getSize(t.d),1):t.p},n.asSpace=function(t){t=n.parseSpace(t);var e,r=[];for(e=0;e<n.dLen;e++)r[e]=n.asPos({d:e,s:t.s});return r},n.addSpaces=function(t,e){if(t=n.parseSpace(t).s,!e)return t;e=n.parseSpace(e).s;for(var r=0;r<n.dLen;r++)"mask"==e[r]&&(e[r]=t[r]);return e},n.nextSpace=function(t,e){if(null==e)throw"zDataCube.nextSpace(): No iterating dimension defined.";return this.addSpaces(t,{d:e,p:t[e]+1})},n.prevSpace=function(t,e){if(null==e)throw"zDataCube.prevSpace(): No iterating dimension defined.";return this.addSpaces(t,{d:e,p:t[e]-1})},n.listSpaces=function(t){var e,r,o=[],a=[],i=za.fill(0,n.dLen),s=n.asSpace(t),l=t.mask?n.parseSpace(t.mask).s:null;if(l)for(e=0;e<n.dLen;e++)"mask"!=l[e]&&(s[e]="mask");for(e=0;e<n.dLen;e++)if(s[e]=za.asArray(s[e]),o[e]=s[e].length-1,o[e]<0)return a;for(i[n.dLen-1]--,e=n.dLen-1;e>=0;e--)if(i[e]<o[e]){for(i[e]++,e++;e<n.dLen;e++)i[e]=0;for(r=[],e=0;e<n.dLen;e++)r[e]=s[e][i[e]];a.push(n.addSpaces(r,l))}return a},n.forPos=function(t,e){var r,o=za.asArray(n.asPos(t));for(r=0;r<o.length;r++)e({d:t.d,p:o[r]})},n.forSpaces=function(t,e){var r,o=n.listSpaces(t);for(r=0;r<o.length;r++)e({s:o[r]})},n.forGenerations=function(t,e,r,o,a){var i,s=n.getMeta("tree",{d:t});if(o=o||0,a=a||0,r)for(i=s.length-1-o;i>=a;i--)e({d:t,p:s[i]});else for(i=o;i<s.length-a;i++)e({d:t,p:s[i]})},n.forMeta=function(t,e,r){var o,a;n.forPos(e,function(e){o=n.getMeta(t,e),a=r(o,e),n.setMeta(t,e,a)})},n.forData=function(t,e,r){var o,a;n.forSpaces(e,function(e){o=n.getData(t,e),a=r(o,e),n.setData(t,e,a)})},n.getSize=function(t,e){if(null!=t){if(!n.meta[t].name)throw"zDataCube.getSize(): Dimension "+t+" does not contain name property.";return e?n.domain[t].length:n.meta[t].name.length}var r=[];for(t=0;t<n.dLen;t++)r[t]=n.getSize(t,e);return r},n.setDomain=function(t,e){if(null!=t)n.oldDomain[t]=n.domain[t],n.domain[t]=e||za.fill(0,n.getSize(t),1);else for(t=0;t<n.dLen;t++)n.setDomain(t)},n.setMeta=function(t,e,r){if(null!=t&&"all"!=t){var o,a=n.asPos(e),i=n.meta[e.d];if(null==a)i[t]=r;else if(i[t]||(logger("zDataCube.setMeta(): Creating new meta of type "+t+" in dimension "+e.d+"."),i[t]=[]),"number"==typeof a)i[t][a]=r;else if(za.isArray(a))for(o=0;o<a.length;o++)i[t][a[o]]=r}else for(t in r){if("all"==t)throw"zDataCube.setMeta(): 'all' is a reserved type name used to call up all types of metadata at once. Don't use it in your data.";n.setMeta(t,e,r[t])}},n.getMeta=function(t,e){var r=n.asPos(e),o=n.meta[e.d];if(!o[t])throw"zDataCube.getMeta(): Metadata type "+t+" in dimension "+e.d+" does not exist.";return null==r?o[t]:za.map(o[t],r)},n.getAllMeta=function(t){var e,r,o=n.asPos(t),a=n.meta[t.d];if(null==o)throw"zDataCube.getAllMeta(): Pos not specified. What do you want me to .getAllMeta() of?.";if(za.isArray(o))for(r=[],e=0;e<o.length;e++)r[e]=n.getAllMeta({d:t.d,p:o[e]});else{r={};for(type in a)r[type]=a[type][o];r.p=o}return r},n.getName=function(t){return n.getMeta("name",t)},n.findMeta=function(t,e,r,o,a){var i=n.asPos(e),s=n.getMeta(t,e),l=za.find(s,r,o,a);return null==i?l:za.map(i,l)},n.findAllMeta=function(t,e,r,o,a){var i=n.asPos(e),s=n.getMeta(t,e),l=za.findAll(s,r,o,a);return null==i?l:za.map(i,l)},n.shyPushMeta=function(t,e,r){var o=n.findMeta(t||"name",{d:e},r.name||r);return null!=o?o:(o=n.getSize(e),n.domain[e].push(o),n.setMeta(t,{d:e,p:o},r),o)},n.calcMeta=function(t,e,r,o,a,i){var s=za.asArray(n.getMeta(e,r));return za.calc(t,s,o,a,i)},n.addCalcMeta=function(t,e,r,o,a,i){var s,l=n.asPos(r),u=zt.camelCase([e,t]),d=n.calcMeta(t,e,r,o,a,i);for(s=0;s<l.length;s++)n.setMeta(u,{d:r.d,p:l[s]},d[s])},n.setColour=function(t,e,r){e=e||zt.getPalette(null,12,"sequential");var o,a,i,s,l,u,d,c=[],f=[],p=n.asPos(t);if("tree"==r||"randomTree"==r){if(e.length<3)throw"zDataCube.setColour(): Can't do a tree assignment with less than 3 colours.";for(o=n.meta[t.d].tree,a=0;a<o.length;a++)for(i=0;i<o[a].length;i++){for(f.length||(f="tree"==r?e.slice():za.getRandom(e,e.length)),l=n.getAllMeta({d:t.d,p:o[a][i]}),s=0;s<f.length;s++){if(d=u&&c[u.p]==f[s]?!1:null!=l.parent&&c[l.parent]==f[s]?!1:!0){c[l.p]=f.splice(s,1)[0];break}s==f.length-1&&(s=-1,za.add(f,"tree"==r?e.slice():za.getRandom(e,e.length)))}u=l}}else c=zt.getPalette(e,p.length,r||"sequential");n.setMeta("colour",{d:t.d},c)},n.addDataType=function(t,e){n.data[t]=e||[]},n.setData=function(t,e,r){za.setDeep(n.data[t],n.asSpace(e),r)},n.getData=function(t,e){return za.getDeep(n.data[t],n.asSpace(e))},n.getVal=function(t){return n.getData("val",t)},n.calcData=function(t,e,r,o,a,i){var s=za.flatten(za.asArray(n.getData(e,r)));return za.calc(t,s,o,a,i)},n.addCalcData=function(t,e,r,o,a,i){var s,l=zt.camelCase([e,t]);return n.data[l]||n.addDataType(l),n.forSpaces(r,function(r){var u=n.calcData(t,e,r,o,a,i),d=n.listSpaces(r);for(s=0;s<d.length;s++)n.setData(l,{s:d[s]},u[s])}),n.getData(e,r)},n.makeTree=function(t){if(null!=t){var e,r,o,a=[],i=[],s=[],l=[],u=[],d=n.meta[t].parent,c=n.meta[t].parentName,f=c?c.length:d?d.length:null;if(c)for(d=[],e=0;e<n.getSize(t);e++)d[e]="root"==c[e]||""==c[e]||null==c[e]?null:n.shyPushMeta("name",t,c[e]);if(!d)return;for(e=0;e<n.getSize(t);e++){if(r=d[e],r==e)throw"zDataCube.makeTree(): UH OH - "+n.getName({d:t,p:e})+" is its own parent. Space-time continuum collapsing.";d[e]=-1==r?null:r,i[e]=[],s[e]=0}for(e=0;e<n.getSize(t);e++)r=d[e],null!=r&&i[r].push(e);for(a=za.findAll(d,null);a.length>0;){for(o=[],e=0;e<a.length;e++)r=a[e],l[r]=u.length,za.add(o,i[r]);u.push(a),a=o}n.setMeta(null,{d:t},{parent:d,children:i,leaves:s,tree:u,generation:l}),n.showNodes({d:t,p:"all"}),logger("zDataCube.makeTree(): "+d.length+" nodes added into "+u.length+" generations in dimension "+t+", with "+(d.length-f)+" imputed nodes.")}else for(t=0;t<n.dLen;t++)n.makeTree(t)},n.addRootNode=function(t,e){var r,o=n.meta[t],a=n.findMeta("name",{d:t},e||"root");for(null==a&&(a=n.getSize(t)),o.generation||(o.parentName=za.fill("root",n.getSize(t)),n.makeTree(t)),r=0;r<o.generation.length;r++)0==o.generation[r]&&(o.parent[r]=a),o.generation[r]++;return n.setMeta(null,{d:t,p:a},{name:e||"root",parent:null,children:o.tree[0],generation:0,leaves:n.calcMeta("sum","leaves",{d:t,p:o.tree[0]})}),o.tree=[[a]].concat(o.tree),n.getAllMeta({d:t,p:a})},n.showNodes=function(t){var e,r,o,a=(n.meta[t.d].leaves,za.asArray(n.asPos(t)));for(e=0;e<a.length;e++)t={d:t.d,p:a[e]},r=n.findParent(t),o=n.calcFamily("children","sum","leaves",t),n.setMeta("leaves",t,Math.max(1,o)),za.shyPush(n.domain[t.d],t.p),null!=r&&n.showNodes({d:t.d,p:r})},n.hideNodes=function(t){var e,r,o,a,i,s=(n.meta[t.d].leaves,n.asPos(t));for(e=0;e<s.length;e++)t={d:t.d,p:s[e]},r={d:t.d,p:n.findParent(t)},o={d:t.d,p:n.findFamily("ancestors",t)},a={d:t.d,p:[s[e]].concat(n.findFamily("descendants",t))},i=n.getMeta("leaves",t),n.getMeta("leaves",r)>i&&i--,n.forMeta("leaves",o,function(t){return t-i}),n.setMeta("leaves",a,0),za.remove(n.domain[t.d],a)},n.findFamily=function(t,e,r){var o,a=[];if("all"==t)a=n.asPos(e);else if("parent"==t)a=n.getMeta("parent",e);else if("children"==t)a=n.getMeta("children",e);else if("descendants"==t)for(o=za.flatten(n.findChildren(e,r));null!=o&&o.length>0;)za.add(a,o),o=za.flatten(n.findChildren({d:e.d,p:o},r));else{var i,s,l,u=n.asPos(e);if("siblings"==t)s=n.findParent(e),l=za.flatten(n.findChildren({d:e.d,p:s})),a=za.subtract(l,u);else if("ancestors"==t)for(i=0;i<n.getMeta("generation",e)&&(u=n.findParent({d:e.d,p:u}),null!=u);i++)a.push(u)}return r&&za.isArray(a)?za.asArray(n.findAllMeta("leaves",{d:e.d,p:a},0,">")):a},n.findParent=function(t){return n.findFamily("parent",t)},n.findChildren=function(t,e){return n.findFamily("children",t,e)},n.findRelationship=function(t,e,r){if(null==n.asPos({d:t,p:e}))return logger("zDataCube.findRelationship(): startAPos "+zt.asString(e)+" is not valid.");if(null==n.asPos({d:t,p:r}))return logger("zDataCube.findRelationship(): endAPos "+zt.asString(r)+" is not valid.");var o,a,i=za.add([e],n.findFamily("ancestors",{d:t,p:e}));for(endToRoot=za.add([r],n.findFamily("ancestors",{d:t,p:r})).reverse(),o=0;o<i.length;o++)if(a=za.find(endToRoot,i[o]),null!=a)return za.add(i.slice(0,o),endToRoot.slice(a));return[]},n.getFamily=function(t,e,r){var o=n.findFamily(t,r);return n.getMeta(e,{d:r.d,p:o})},n.calcFamily=function(t,e,r,o,a){var i=n.findFamily(t,o,a),s=n.getMeta(r,{d:o.d,p:i});return za.calc(e,s)},n.calcTreeMeta=function(t,e,r){if("stacked"==t){var o=n.meta[r].tree;n.addCalcMeta("stacked",e,{d:r,p:o[0]},0),n.forGenerations(r,function(t){n.forPos(t,function(t){var o,a=n.getMeta(e+"Stacked",t),i={d:r,p:n.findChildren(t)};n.addCalcMeta("stacked",e,i,a.start),o=za.mergeStacked(n.getMeta(e+"Stacked",i))})},!1,0,1)}else n.forGenerations(r,function(r){n.forMeta(e,r,function(r,o){var a=n.calcFamily("children",t,e,o);return a})},!0,1,0)},n.calcTreeData=function(t,e,r){n.forSpaces({s:"all",mask:{d:r,p:"na"}},function(o){"stacked"==t?(o.s[r]=n.getMeta("tree",{d:r})[0],n.addCalcData("stacked",e,o,0),n.forGenerations(r,function(t){n.forData(e+"Stacked",{s:n.addSpaces(o,t)},function(t,o){return o.mask={d:r,p:n.findChildren({d:r,s:o.s})},n.addCalcData("stacked",e,o,t.start),t})},!1,0,1)):n.forGenerations(r,function(a){n.forData(e,{s:n.addSpaces(o,a)},function(a,i){return null!=a&&""!=a?a:(o.s[r]=n.findChildren({d:r,s:i.s}),n.calcData(t,e,o))})},!0,1,0)})},n.verifyTreeData=function(t,e,r){n.forSpaces({s:"all",mask:{d:r,p:"na"}},function(o){"stacked"==t?n.forGenerations(r,function(t){n.forData(e+"Stacked",{s:n.addSpaces(o,t)},function(t,a){if(o.s[r]=n.findChildren({d:r,s:a.s}),o.s[r].length){var i=za.mergeStacked(n.getData(e+"Stacked",o));zo.equals(i,t)||logger("zDataCube.calcTreeData(): UH OH - Range for node "+zt.asString(n.getName({d:r,s:a.s}))+" is "+zt.asString(t)+", but its children is "+zt.asString(i)+" (type:"+e+").")}else logger("zDataCube.calcTreeData(): Hmm - "+zt.asString(n.getName({d:r,s:a.s}))+" is in generation "+n.getMeta("generation",{d:r,s:a.s})+" of "+n.meta[r].tree.length+", but it has no children. Just sayin'.");return t})},!1,0,1):n.forGenerations(r,function(a){n.forData(e,{s:n.addSpaces(o,a)},function(a,i){if(o.s[r]=n.findChildren({d:r,s:i.s}),o.s[r].length){var s=n.calcData(t,e,o);zo.equals(s,a)||logger("zDataCube.calcTreeData(): UH OH - Value for node "+zt.asString(i)+" is "+zt.asString(a)+", but its children is "+zt.asString(s)+" (type:"+e+").")}else logger("zDataCube.calcTreeData(): Hmm - "+zt.asString(n.getName({d:r,s:i.s}))+" is in generation "+n.getMeta("generation",{d:r,s:i.s})+" of "+n.meta[r].tree.length+", but it has no children. Just sayin'.");return a})},!0,1,0)})},n.importDumb=function(t){return n.meta[0].name=t||[],n.setDomain(),n},n.importStrip=function(e,r){var o,a,i,s,l,u,d,c=[],f={};for(o=0;o<e[0].length;o++)a=e[0][o].split("~"),2==a.length?(i=a[0],l=a[1],c[i]=c[i]||{},c[i][l]&&logger("zDataCube.importStrip(): UH OH - "+c[i][l]+" already exists."),c[i][l]=o):1==a.length?(l=a[0],f[l]=o):logger("zDataCube.importStrip(): UH OH - I don't understand header "+e[0][o]+". Metadata headers should be [dimension]~[type] (e.g. '0~name'), data headers should be [type] (e.g. 'data').");for(zo.isEmpty(f)&&logger("zDataCube.importStrip(): UH OH - no data found in strip."),zo.isEmpty(c)&&logger("zDataCube.importStrip(): UH OH - no metadata found in strip."),i=0;i<c.length;i++)null==c[i].name&&logger("zDataCube.importStrip(): UH OH - no name found for dimension "+i+".");if(!r)for(n.dLen=t,i=0;t>i;i++)n.meta[i]={name:[]},n.domain[i]=[],n.oldDomain[i]=[];for(s in f)n.addDataType(s);for(o=1;o<e.length;o++){for(u=e[o],d=[],i=0;i<n.dLen;i++)if(d[i]=n.findMeta("name",{d:i},u[c[i].name]),null==d[i]){a={};for(s in c[i])a[s]=u[c[i][s]];d[i]=n.shyPushMeta(null,i,a)}for(s in f)n.setData(s,{s:space},u[f[s]])}return n.setDomain(),n.makeTree(),n},n.importProtoCube=function(t){var e,r;n.dLen=t.meta.length,n.meta=t.meta;for(e in t.data)if(t.data[e]instanceof Array)n.data[e]=t.data[e];else{if("object"!=typeof t.data[e])throw"zDataCube.importProtoCube: ERROR! Type "+e+" in source data doesn't make sense.";n.addDataType(e);for(r in t.data[e])n.setData(e,r.split(","),t.data[e][r])}n.setDomain(),n.makeTree();for(var o=0;o<n.dLen;o++)n.meta[o].displayName&&n.forMeta("name",{d:o,p:"all"},function(t,e){return n.meta[o].displayName[e.p]||t});return n},n.debug=function(t){var e,r;for(e in n.data)console.log("type = "+e+":",n.getData(e,t));for(r=0;r<n.dLen;r++)t.d=r,console.log("d = "+r+":",n.getName(t))},n.init=function(e){n.meta=[],n.domain=[],n.oldDomain=[],n.data={},n.dLen=t;for(var r=0;t>r;r++)n.meta[r]={name:[]},n.domain[r]=[],n.oldDomain[r]=[];e&&(e.meta&&e.data?n.importProtoCube(e):e instanceof Array&&(e[0]instanceof Array?n.importStrip(e):n.importDumb(e)))},n.init(e)}function zCanvas(t,e){e=e||"#chewy";var n=this;if(n._canvas=this,n.$=$(e),!n.$.is("svg"))throw e+" is not an SVG object.";return n.isiPad=null!=navigator.userAgent.match(/iPad/i),n.nofo=!document.implementation.hasFeature("www.http://w3.org/TR/SVG11/feature#Extensibility","1.1"),n.el=n.$.get()[0],n.d3=d3.select(e).style("position","relative"),n.parent={d3:d3.select("body")},n.parent.el=n.parent.d3.node(),n.parent.$=$(n.parent.el),n.setSize=function(t){return t=t||zt.getMaxLayout(),n.d3.attr({width:Math.round(t.width),height:Math.round(t.height)}),n},n.setSize(t),n}function zDrone(t,e,n){return this._canvas=CANVAS,this.add(t,e,n),this}function zContainer(t){return new zDrone(t)}function zComplex(t,e,n){return t.type=t.type||"zComplex",new zDrone(t,e,n)}function zLine(t,e,n){return t.type=t.type||"zLine",t._a={type:"line"},new zDrone(t,e,n)}function zShape(t,e,n){return t.type=t.type||"zLine",t._a={type:"line"},new zDrone(t,e,n)}function zArc(t,e,n){return t.type=t.type||"zArc",t._a={type:"arc"},new zDrone(t,e,n)}function zCircle(t,e,n){return t.type=t.type||"zCircle",t._a={type:"circle"},new zDrone(t,e,n)}function zRectangle(t,e,n){return t.type=t.type||"zRectangle",t._a={type:"rect"},new zDrone(t,e,n)}function zText(t,e,n){return t.type=t.type||"zText",t._a={type:"text"},new zDrone(t,e,n)}function zHTML(t,e,n){t.type=t.type||"zHTML",t._a={type:"html",plot:function(t,e){if(t){var n,r=this;if(r.L.set(t.layout||t.L),t.text&&(t.content=zo.r(t,"text")),t.content||r.L.changed){if(t.content&&r.d3.html(zo.r(t,"content")),r.L.padding&&r.d3.style("padding",r.L.padding+"px"),!r.L.autoWidth&&r.L.innerWidth&&(n=parseInt(r.d3.style("padding-left"),10)+parseInt(r.d3.style("padding-right"),10),r.d3.style("width",r.L.width-n+"px")),!r.L.autoHeight&&r.L.innerHeight&&(n=parseInt(r.d3.style("padding-top"),10)+parseInt(r.d3.style("padding-bottom"),10),r.d3.style("height",r.L.height-n+"px")),r.L.autoWidth||r.L.autoHeight){var o=r.$.clone();o.css({position:"absolute","font-size":r.d3.style("font-size"),"font-weight":r.d3.style("font-weight")}),$(r.el).attr({width:2e4,height:2e4}),CANVAS.parent.$.append(o),r.L.autoWidth&&(r.d3.style("width",1+o.outerWidth()+"px"),r.L.set({width:r.$.outerWidth()})),r.L.autoHeight&&r.L.set({height:r.$.outerHeight()}),o.remove()}if(e._canvas.nofo){var a=e._canvas.$.offset();console.log(r.L.width,r.$.outerWidth()),console.log(r.L.height,r.$.outerHeight()),$(r.el).css({position:"absolute",left:a.left+r.L.left+"px",top:a.top+r.L.top+"px"})}else $(r.el).attr({x:Math.round(r.L.left),y:Math.round(r.L.top),width:r.$.outerWidth(),height:r.$.outerHeight()});r.L!=e.L&&(r.L.changed=!1)}return t}},make:function(t,e){if(e._canvas.nofo){var n=e._makePart("div",t);n.d3=n.d3.append("div")}else{var n=e._makePart("foreignObject",t);n.d3=n.d3.append("xhtml:div")}return n.$=$(n.d3.node()),n.L=e._parseLayout(t,!0),n}},t.content&&(t._a.content=zo.r(t,"content"));var r=new zDrone(t,e,n);return r}function zTextBox(t,e,n){t=zo.initOrders(t);var r=t.background,o=t.branch;return t.textObj=t.textObj||{text:""},t.textObj.type="text",t.textObj.layer=2,t.text&&(t.textObj.text=t.text,delete t.text),r&&("object"!=typeof r&&(r={}),r.type="rect",r.layer=0,delete t.background,t.background=r),(o&&t.layout&&null!=t.layout.radial||t.L&&null!=t.L.radial)&&(o.type="branch",o.layer=1,delete t.branch,t.branch=o),t.type=t.type||"zTextBox",new zDrone(t,e,n)}function zTooltipBox(t){t=zo.initOrders(t,{type:"zTooltipBox",id:"tooltip",layout:{align:"rightBottom",padding:10,rounded:8},"font-size":14,fill:"#eee",background:{stroke:null,fill:"black",opacity:.85}});var e=new zTextBox(t);return e.hide(),e.hover(function(){e.show(100)},function(){e.hide(100)}),e.click(function(){e.hide(100)}),e}function zHTMLTooltipBox(t){t=zo.initOrders(t,{type:"zHTMLTooltipBox",id:"tooltip",text:"Empty tooltip",layout:{align:"rightBottom"}});var e=new zHTML(t);return e.hide(),e.hover(function(){e.show(100)},function(){e.hide(100)}),e.click(function(){e.hide(100)}),e}function zNarrator(t){t=zo.initOrders(t,{type:"zNarrator",id:"narrator",layout:{padding:20},content:"<div id='content'>bfgb</div><br><br><div id='nav'><a href=javascript:void(0) id='prev'>Prev</a><a href=javascript:void(0) id='next'>Next</a><div id='middle'><div id='pageCount'></div><a href=javascript:void(0) id='close'>Close</a></div></div>"});var e=zo.r(t,"script"),n=zo.r(t,"onClose"),r=new zHTML(t);return r.setScene=function(t){var e=r.script[t-1];r.page=t,t>r.script.length?(r.remove(200),r.onClose&&r.onClose()):(1==t?r.elements.prev.hide():2==t?r.elements.prev.show():t==r.script.length-1?r.elements.next.html("Next"):t==r.script.length&&r.elements.next.html("Close"),r.elements.content.html(e.content),r.elements.pageCount.html(t+"/"+r.script.length),e.action&&e.action(),r.L.changed=!0,r.attr({layout:e.layout}))},r.script=e,r.onClose=n,r.elements={content:$("#narrator #content"),prev:$("#narrator #nav #prev"),next:$("#narrator #nav #next"),pageCount:$("#narrator #nav #middle #pageCount"),close:$("#narrator #nav #middle #close")},r.elements.close.click(function(){r.setScene(r.script.length+1)}),r.elements.prev.click(function(){r.setScene(r.page-1)}),r.elements.next.click(function(){r.setScene(r.page+1)}),r.setScene(1),r}function zGladwrap(t){t=zo.initOrders(t,{type:"zGladwrap",layer:99});var e=new zRectangle(t);return e.Y=e.Y||{},e.Y.snap=20,e._getLine=function(t){var n=e.parent;return[n.getPoint(t[0]),n.getPoint(t[1])]},e.getClosestSegment=function(t,n,r,o){var a,i,s,l,u,c,f=e.parent;return dc=f.dc,d=r.d,out={s:null,dist:e.Y.snap},mousePos=e.getEventPos(t),o||(a=r.scale.range(),i=r.scale.domain(),s=za.find(a,mousePos.x,"closest"),s=zt.forceBetween(s,1,a.length-1),s=[s-1,s,s+1],s=za.map(i,s),n.s=dc.addSpaces(n.s,{d:d,p:s})),dc.forSpaces(n,function(t){l=[t.s,dc.nextSpace(t.s,d)],u=e._getLine(l),c=zp.distToLine(mousePos,u),c<out.dist&&(out={s:l,dist:c})}),out},e.getClosestPoint=function(t,n,r){var o,a,i=e.getEventPos(t),s=e.getClosestSegment(t,n,r).s;return s&&(o=e._getLine(s),a=[zp.dist(o[0],i),zp.dist(o[1],i)],s=a[0]<=a[1]?s[0]:s[1]),s},e}function zGuide(){var t=this;return t._canvas=CANVAS,t.redraw=function(e,n,r){if(!t.scripting){var o=t.thread=$.now();return"number"==typeof n&&(n={t:n}),n&&n.t?(t.animating=!0,t.dec=0,t.easer=d3.ease(n.e||"quad-in-out"),t.frames=0,d3.timer(function(a){if(t.thread!=o||!t.animating)return!0;var i=Math.min(a/n.t,1);return t.dec=t.easer(i),e&&e(),t.frames++,1==i?(t.animating=!1,r&&r(),!0):void 0}),void 0):(e&&e(),void(r&&r()))}},t.delay=function(t,e){this.redraw(null,t,e)},t.stop=function(){t.animating=!1},t.runScript=function(e){if(e&&e.length){var n=e.shift(),r=n[0]||1,o=n[1];t.delay(r,function(){t.runScript(e)}),t.scripting=!0,o&&o(r),t.scripting=!1}},t}function zSwarm(t,e,n){var r,o,a=this;a._canvas=CANVAS,a.drones=[],a.axes={},a.highlighted=[],a.container=new zContainer({id:t.id,type:"zSwarm"}),a.parent=a.container.parent,a.el=a.container.el,a.$=a.container.$,a.d3=a.container.d3,a.attach=a.container.attach,a.toFront=a.container.toFront,a._makeTransition=a.container._makeTransition,a._highlight=a.highlight,a._select=a.select,a._deselect=a.deselect,a._show=a.show,a._hide=a.hide,t=zo.initOrders(t);for(r in t)a[r]=t[r];a.s=a.s||"all",a.dc&&(a.s=a.dc.asSpace(a.s)),a.Y=zo.parseStyle(a.Y||a.style||{}),a.L=a.layout=new zLayout(a.L||a.layout,a),a.P=a.plan,a.roles={};for(r in a.plan)o=a.plan[r],o?(o.name=r,null==o.mask?o.mask="fixed":"fixed"!=o.mask&&(o.mask=a.dc.parseSpace(o.mask)),a.roles[r]=new zContainer({id:r,type:o.type,parent:a,layer:o.layer})):delete a.plan[r];a.G=new zGuide,a.currDec=1;for(r in a.axes)a.axes[r].swarms&&a.axes[r].swarms.push(a);a.onInit&&a.onInit(),a.updateData&&a.updateData(e),a.add("fixed",e),a.add("all",e,n)}var DEBUG_MODE=!1;window.console=window.console||{log:function(){}};var startTime=$.now(),JSONerror=function(t,e){logger(404==t.status?"JSONerror(): JSON file not found.":"JSONerror(): Cannot parse JSON file. Error type '"+e+"'.")},logger=function(t){void 0!==window.console&&window.console.log($.now()-startTime+": "+t)},error=function(t){if(DEBUG_MODE)throw t;logger(t)},logobj=function(t){void 0!==window.console&&window.console.log($.now()-startTime+": "+zt.asString(t))},zDebug={startTime:function(){this._currTime=$.now(),console.log("---------------")},time:function(t){var e=$.now()-this._currTime;this._currTime=$.now(),console.log(t+":",e)},checkIE:function(){if("Microsoft Internet Explorer"==navigator.appName){var t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(null!=t.exec(navigator.userAgent))return parseFloat(RegExp.$1)}return-1},what:function(t,e,n,r,o){console.log("scope:",this),console.log("arguments:",t,e,n,r,o)},hi:function(){console.log("Hi there!")},show:function(t,e,n){e=e||"red";var r;null!=t.left&&null!=t.right&&null!=t.top&&null!=t.bottom?r=new zShape({points:zp.boxToPoints(t),stroke:e,"stroke-width":1,fill:"none"}):za.isArray(t)&&null!=t[0].x&&null!=t[0].y?r=new zLine({points:t,stroke:e,"stroke-width":.5}):null!=t.x&&null!=t.y&&(r=new zCircle({centre:t,radius:3,fill:e})),r.remove(n||5e3)},mapShow:function(t,e,n,r){zDebug.show(zt.mapPoints(t,e,n),r)},name:function(t,e){var n,r=[];for(n=0;n<e.length;n++)r[n]=t.getName({d:n,s:e});return r},button:function(t,e){var n=new zCircle({centre:e||{x:20,y:20},radius:10,stroke:"#666",fill:"#888",opacity:.3});n.click(t)}},zPlot=zp={isPoint:function(t){return null!=t.x&&null!=t.y},pointToString:function(t,e){return d3.round(t.x,e)+","+d3.round(t.y,e)},arcToPoints:function(t,e,n,r,o){for(;0>r;)r+=360,o+=360;var a,i=[],s=function(r){e&&i.push(zp.addVector(r,e,t)),i.push(zp.addVector(r,n,t))};for(e||i.push(t),s(r),a=90;360>=a;a+=90)zt.isBetween(a,r,o)&&s(a);return s(o),i},decToDeg:function(t){return 360*(t||0)-90},decToRad:function(t){return 2*(t||0)*Math.PI},degToDec:function(t){return(t||0)/360},degToRad:function(t){return(t||0)*Math.PI/180},radToDec:function(t){return(t||0)/2/Math.PI},radToDeg:function(t){return 180*(t||0)/Math.PI},sin:function(t){return Math.sin(zp.degToRad(t))},cos:function(t){return Math.cos(zp.degToRad(t))},tan:function(t){return Math.tan(zp.degToRad(t))},asin:function(t){return zp.radToDeg(Math.asin(t))},acos:function(t){return zp.radToDeg(Math.acos(t))},atan:function(t){return zp.radToDeg(Math.atan(t))},matchDeg:function(t,e){for(null==e&&(e=180);t>=e+180;)t-=360;for(;e-180>t;)t+=360;return t},degDiff:function(t,e){return d3.round(Math.abs(zp.matchDeg(t)-zp.matchDeg(e)),10)},dist:function(t,e){var n=e.x-t.x,r=e.y-t.y;return 0==n&&0==r?0:Math.sqrt(n*n+r*r)},distToLine:function(t,e){var n,r,o=[zp.dist(e[0],t),zp.dist(e[1],t),zp.dist(e[0],e[1])],a=[zp.matchDeg(zp.deg(e[0],e[1])-zp.deg(e[0],t)),zp.matchDeg(zp.deg(e[1],e[0])-zp.deg(e[1],t))];return zt.isBetween(a[0],90,270)?o[0]:zt.isBetween(a[1],90,270)?o[1]:(n=za.sum(o)/2,r=Math.sqrt(n*(n-o[0])*(n-o[1])*(n-o[2])),2*r/o[2])},deg:function(t,e){var n=e.x-t.x,r=e.y-t.y;return 0==n&&0==r?0:zp.radToDeg(Math.atan2(r,n))},vector:function(t,e){var n=e.x-t.x,r=e.y-t.y;return 0==n&&0==r?{x:0,y:0,deg:0,dist:0}:{x:n,y:r,deg:zp.radToDeg(Math.atan2(r,n)),dist:Math.sqrt(n*n+r*r)}},addVector:function(t,e,n){if(-90==t)return{x:n.x,y:n.y-e};if(0==e)return n;var r=zp.degToRad(t);return{x:n.x+Math.cos(r)*e,y:n.y+Math.sin(r)*e}},alignmentToDec:function(t){switch(t){case"right":case"bottom":return 1;case"xCentre":case"yCentre":return.5;case"left":case"top":return 0;default:return logger("zTools.alignmentToDec(): "+t+" doesn't look like an alignment.")}},inverseAlignment:function(t){switch(t){case"xCentre":return"xCentre";case"left":return"right";case"right":return"left";case"yCentre":return"yCentre";case"top":return"bottom";case"bottom":return"top"}},completeBox:function(t){return t instanceof zLayout?t:(t=zo.clone(t),t.anchor?(t.x=t.anchor.x,t.y=t.anchor.y):t.anchor={x:t.x,y:t.y},t.xAlign&&(t[t.xAlign]=t.x),t.yAlign&&(t[t.yAlign]=t.y),t.left=null!=t.left?t.left:null!=t.right&&null!=t.width?t.right-t.width:null!=t.xCentre&&null!=t.width?t.xCentre-t.width/2:t.x||0,t.top=null!=t.top?t.top:null!=t.bottom&&null!=t.height?t.bottom-t.height:null!=t.yCentre&&null!=t.height?t.yCentre-t.height/2:t.y||0,t.width=null!=t.width?t.width:null!=t.right?t.right-t.left:0,t.height=null!=t.height?t.height:null!=t.bottom?t.bottom-t.top:0,t.right=null!=t.right?t.right:t.left+t.width,t.bottom=null!=t.bottom?t.bottom:t.top+t.height,t.xCentre=null!=t.xCentre?t.xCentre:zt.calcMid(t.left,t.right),t.yCentre=null!=t.yCentre?t.yCentre:zt.calcMid(t.top,t.bottom),t.centre={x:t.xCentre,y:t.yCentre},t)},pointsToBox:function(t){var e=za.calcObjects(t,"x","sort"),n=za.calcObjects(t,"y","sort");return{left:e[0],right:za.last(e),top:n[0],bottom:za.last(n)}},boxToPoints:function(t){return[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.right,y:t.bottom},{x:t.left,y:t.bottom}]},boxToArray:function(t){return[t.left,t.top,t.right-t.left,t.bottom-t.top]},start:function(t){return"M"+zp.pointToString(t||{x:0,y:0})},lineTo:function(t){return"L"+zp.pointToString(t)},quadraticCurveTo:function(t,e){return"Q"+zp.pointToString(t)+","+zp.pointToString(e)},arcTo:function(t,e){return"A"+t+","+t+",0,0,1,"+zp.pointToString(e)},reverseArcTo:function(t,e){return"A"+t+","+t+",0,0,0,"+zp.pointToString(e)},close:function(){return"Z"},line:function(t){for(var e=zp.start(t[0]),n=1;n<t.length;n++)e+=zp.lineTo(t[n]);return e},shape:function(t){return zp.line(t)+"Z"},arc:function(t){var e,n,r,o,a=t.degEnd-t.degStart,i=t.minSeg||Math.ceil(a/90),s=a/i;if(t.innerRadius)for(t.innerRadius=d3.round(t.innerRadius,2),n=zp.start(zp.addVector(t.degStart,t.innerRadius,t.centre)),e=1;i>=e;e++)r=t.degStart+e*s,o=zp.addVector(r,t.innerRadius,t.centre),n+=zp.arcTo(t.innerRadius,o);else n=zp.start(t.centre);if(t.outerRadius>t.innerRadius)for(t.outerRadius=d3.round(t.outerRadius,2),n+=zp.lineTo(zp.addVector(t.degEnd,t.outerRadius,t.centre)),e=i-1;e>=0;e--)r=t.degStart+e*s,o=zp.addVector(r,t.outerRadius,t.centre),n+=zp.reverseArcTo(t.outerRadius,o);return n+"Z"},circle:function(t,e){e=d3.round(e,2);var n,r=-135,o=4,a=360/o,i=zp.start(zp.addVector(r,e,t));if(e)for(n=1;o>=n;n++)i+=zp.arcTo(e,zp.addVector(r+n*a,e,t));return i},sCurveTo:function(t,e,n){e=e||4;var r=zp.vector(t[0],t[1]),o=r.dist/zp.cos(90-r.deg)/e,a=[zo.add(t[0],n?{x:o}:{y:o}),zo.add(t[1],n?{x:-o}:{y:-o})];return zp.quadraticCurveTo(a[0],zo.mid(t[0],t[1]))+zp.quadraticCurveTo(a[1],t[1])},flag:function(t,e,n){return"xCentre"!=t.yAlign?zp.vflag(t,e,n):zp.completeBox(t)},vflag:function(t,e,n){t=new zLayout(t);var r=e/t.width,o=n/t.height;return[t.getPoint(0,o),t.getPoint(0,1+o),t.getPoint(1,1+o),t.getPoint(1,o)].concat("xCentre"==t.xAlign?[t.getPoint(.5+r,o),t.getPoint(.5,0),t.getPoint(.5-r,o)]:[t.getPoint(r,o),t.getPoint(0,0)])}},zArray=za={forEach:function(t,e,n){n=n||0,e(t[n],n)||(n++,n<t.length&&za.forEach(t,e,n))},asArray:function(t){return za.isArray(t)?t:[t]},asObject:function(t){if(za.isArray(t)){var e,n={};for(e=0;e<t.length;e++)n[e]=t[e];return n}return t},isEmpty:function(t){return null==t||0==t.length},isArray:function(t){return $.isArray(t)},fill:function(t,e,n){var r,o=[];if(n)for(r=0;e>r;r++)o[r]=t+r*n;else for(r=0;e>r;r++)o[r]=zo.clone(t);return o},fillRange:function(t){return za.fill(t[0],Math.abs(t[0]-t[1])+1,t[0]<t[1]?1:t[0]>t[1]?-1:0)},last:function(t){return t[t.length-1]},insertAt:function(t,e,n){return t.slice(0,n).concat(za.asArray(e),t.slice(n+1))},removeAt:function(t,e){return null==e?null:t.splice(e,1)[0]},shyPush:function(t,e){return za.contains(t,e)?t:t.push(e)},shyConcat:function(t,e){for(var n=0;n<e.length;n++)za.shyPush(t,e[n]);return t},shyInsert:function(t,e,n){return za.contains(t,e)?t:za.insertAt(t,e,n)},index:function(t){var e,n=[];for(e=0;e<t.length;e++)n[e]={id:e,val:t[e]};return n},sort:function(t,e){return t.sort(function(t,e){return t>e?1:e>t?-1:0}),e?t.reverse():t},map:function(t,e){if("number"==typeof e)return t[e];if(za.isArray(e)){var n,r=[];for(n=0;n<e.length;n++)r[n]=t[e[n]];return r}return t},unmap:function(t,e){if("number"==typeof e)return za.find(t,e);if(za.isArray(e)){var n,r=[];for(n=0;n<e.length;n++)r[n]=za.find(t,e[n]);return r}return t},_compareTests:{"==":function(t,e){return t==e},"===":function(t,e){return t===e},"<":function(t,e){return e>t},"<=":function(t,e){return e>=t},">":function(t,e){return t>e},">=":function(t,e){return t>=e},"><":function(t,e,n){return t>e&&n>t},">=<":function(t,e,n){return t>=e&&n>=t},"<>":function(t,e,n){return e>t||t>n},"<=>":function(t,e,n){return e>=t||t>=n},"!=":function(t,e){return t!=e},type:function(t,e){return zt.type(t)==e},atPos:function(t,e,n){return t[n]==e},equals:function(t,e,n){return zo.equals(t,e,n)},superset:function(t,e,n){return za.isSuperset(t,e,n)},subset:function(t,e,n){return za.isSubset(t,e,n)},intersects:function(t,e){return za.intersects(t,e)},match:function(t,e){return za.contains(e,t)},notMatch:function(t,e){return!za.contains(e,t)},max:"special",min:"special",closest:"special"},compareTests:function(t){return za._compareTests[t]},find:function(t,e,n,r){n=n||"==";var o,a=za.compareTests(n);if(!t)throw"zArray.find(): Trying to run find, but array is empty.";if("function"==typeof a)for(o=0;o<t.length;o++)if(a(t[o],e,r))return o;return"special"==a?za.find(t,za[n](t,e,r)):null},findLast:function(t,e,n,r){n=n||"==";var o,a=za.compareTests(n);if("function"==typeof a)for(o=t.length-1;o>=0;o--)if(a(t[o],e,r))return o;return"special"==a?za.findLast(t,za[n](t,e,r)):null},findAll:function(t,e,n,r){n=n||"==";var o,a=[],i=za.compareTests(n);if("function"==typeof i){for(o=0;o<t.length;o++)i(t[o],e,r)&&a.push(o);return a}return"special"==i?za.findAll(t,za[n](t,e,r)):null},get:function(t,e,n,r){var o=za.find(t,e,n,r);return null==o?null:t[o]},getLast:function(t,e,n,r){var o=za.findLast(t,e,n,r);return null==o?null:t[o]},getAll:function(t,e,n,r){var o=za.findAll(t,e,n,r);return za.map(t,o)},remove:function(t,e,n,r){var o=za.find(t,e,n,r);return za.removeAt(t,o)},removeLast:function(t,e,n,r){var o=za.findLast(t,e,n,r);return za.removeAt(t,o)},removeAll:function(t,e,n,r){var o,a=[],i=za.sort(za.findAll(t,e,n,r),!0);for(o=0;o<i.length;o++)a.push(za.removeAt(t,i[o]));return a},replace:function(t,e,n,r,o){var a=za.find(t,n,r,o);return t[a]=e,a},replaceLast:function(t,e,n,r,o){var a=za.findLast(t,n,r,o);return t[a]=e,a},replaceAll:function(t,e,n,r,o){var a,i=za.findAll(t,n,r,o);for(a=0;a<i.length;a++)t[i[a]]=e;return i},contains:function(t,e,n,r){return null!=za.find(t,e,n,r)},extract:function(t,e){for(var n=[],r=0;r<t.length;r++)n[r]=t[r][e];
return n},sortObjects:function(t,e,n){var r=t.slice();return r.sort(function(t,n){return t[e]>n[e]?1:n[e]>t[e]?-1:0}),n?r.reverse():r},calcObjects:function(t,e,n,r){var o=za.extract(t,e);return n?za[n]?za[n](o,r):void 0:o},findObject:function(t,e,n,r,o){return za.find(za.extract(t,e),n,r,o)},findLastObject:function(t,e,n,r,o){return za.findLast(za.extract(t,e),n,r,o)},findAllObjects:function(t,e,n,r,o){return za.findAll(za.extract(t,e),n,r,o)},getObject:function(t,e,n,r,o){var a=za.findObject(t,e,n,r,o);return null==a?null:t[a]},getLastObject:function(t,e,n,r,o){var a=za.findLastObject(t,e,n,r,o);return null==a?null:t[a]},getAllObjects:function(t,e,n,r,o){var a=za.findAllObjects(t,e,n,r,o);return za.map(t,a)},removeObject:function(t,e,n,r,o){var a=za.findObject(t,e,n,r,o);return za.removeAt(t,a)},removeLastObject:function(t,e,n,r,o){var a=za.findLastObject(t,e,n,r,o);return za.removeAt(t,a)},removeAllObjects:function(t,e,n,r,o){var a,i=[],s=za.sort(za.findAllObjects(t,e,n,r,o),!0);for(a=0;a<s.length;a++)za.add(i,za.removeAt(t,s[a]));return i},add:function(t,e){return $.merge(t,e)},subtract:function(t,e,n){t=za.asArray(t),e=za.asArray(e);var r,o=t.slice();for(r=0;r<e.length;r++)za.remove(o,e[r],"equals",n);return o},multiply:function(t,e){var n=[];for(i=0;i<t.length;i++)for(j=0;j<e.length;j++)n.push(t[i]instanceof Array?e[i]instanceof Array?t[i].concat(e[j]):t[i].concat([e[j]]):[t[i],e[j]]);return n},union:function(t,e){return za.getUniques(t.concat(e))},intersection:function(t,e){return za.getAll(t,e,"match")},isSubset:function(t,e,n){return e.length-t.length<n?!1:0==za.subtract(t,e).length},isSuperset:function(t,e,n){return za.isSubset(e,t,n)},intersects:function(t,e){return null!=za.intersection(t,e)},calc:function(t,e,n,r,o){return za[t]?za[t](e,n,r,o):void logger("zArray.calc(): I don't know how to calculate "+t+".")},sum:function(t){t=za.getNumbers(t);var e,n=0;for(e=0;e<t.length;e++)n+=t[e];return n},max:function(t){return Math.max.apply({},za.getNumbers(t))},min:function(t){return Math.min.apply({},za.getNumbers(t))},range:function(t){return[za.min(t),za.max(t)]},diff:function(t){return t[1]-t[0]},mean:function(t){return t=za.getNumbers(t),za.sum(t)/t.length},median:function(t){return za.percentile(t,.5)},percentile:function(t,e){t=za.sort(za.getNumbers(t));var n=(t.length-1)*e;return zt.calcMid(t[Math.floor(n)],t[Math.ceil(n)],n-Math.floor(n))},closest:function(t,e){var n,r={diff:1/0};for(n=0;n<t.length;n++)curr={val:t[n],diff:Math.abs(e-t[n])},curr.diff<r.diff&&(r=curr);return r.val},rank:function(t,e){var n,r=[];for(t=za.sortObjects(za.index(t),"val",e),n=0;n<t.length;n++)r[t[n].id]=n;return r},dec:function(t){var e,n=[],r=za.sum(t);if(r)for(e=0;e<t.length;e++)if(isNaN(t[e]))for(e=0;e<t.length;e++)n[e]=0;else n[e]=t[e]/r;return n},stacked:function(t,e){var n,r,o=[],a=e||0;for(n=0;n<t.length;n++)r=isNaN(t[n])?0:t[n],o[n]={start:a,end:a+=r};return o},change:function(t){var e,n,r=0,o=[];for(e=0;e<t.length;e++)n=isNaN(t[e])?0:t[e],o[e]=n-r,r=n;return o},decChange:function(t){var e,n=0,r=[];for(e=0;e<t.length;e++)r[e]=t[e]?n?t[e]/n-1:1:n?-1:0,n=t[e];return r},totalChange:function(t){var e,n,r=[],o=t[0]||0;for(e=0;e<t.length;e++)n=isNaN(t[e])?0:t[e],r[e]=n-o;return r},totalDecChange:function(t){var e,n=[];for(e=0;e<t.length;e++)n[e]=t[e]?t[0]?t[e]/t[0]-1:1:t[0]?-1:0;return n},createDeep:function(t,e){var n,r=[],o=t[0],a=t.slice(1);if(t.length>1)for(n=0;o>n;n++)r[n]=za.createDeep(a,e);else for(n=0;o>n;n++)r[n]=e;return r},getDeep:function(t,e){var n,r,o,a=[];for(n=0;n<e.length&&null!=t;n++){if(e[n]instanceof Array){for(o=e.slice(n+1),r=0;r<e[n].length;r++)a[r]=za.getDeep(t,[e[n][r]].concat(o));return a}t=t[e[n]]}return t},setDeep:function(t,e,n){for(var r=0;r<e.length-1;r++)null==t[e[r]]&&(t[e[r]]=[]),t=t[e[r]];t[e[r]]=n},deepLength:function(t){for(var e=[],n=t;za.isArray(n);)e.push(n.length),n=n[0];return e},flatten:function(t){var e,n=[];for(e=0;e<t.length;e++)za.isArray(t[e])?za.add(n,za.flatten(t[e])):n.push(t[e]);return n},getNumbers:function(t){return za.getAll(za.asArray(t),"number","type")},getUniques:function(t){var e,n=[];for(t=za.sort(t.slice()),e=0;e<t.length;e++)t[e]!=t[e-1]&&n.push(t[e]);return n},getRandom:function(t,e,n){if(null==e||1==e){if(!t)throw"zArray.getRandom(): Can't get a random element from an undefined array.";return t[Math.round(Math.random()*(t.length-1))]}var r,o,a=[],i=za.fill(0,t?t.length:e,1);if(null==n||"random"==n)for(;a.length<e;)a.push(Math.round(Math.random()*(i.length-1)));else if("randomNoRepeat"==n)for(;a.length<e;)for(o=i.slice(),r=0;e>r;r++)a.push(za.removeAt(o,Math.round(Math.random()*(o.length-1))));else if("sequential"==n)for(;a.length<e;)za.add(a,i);if(t)for(r=0;e>r;r++)a[r]=t[a[r]];return a},mergeStacked:function(t){return{start:za.calcObjects(t,"start","min"),end:za.calcObjects(t,"end","max")}}},zObject=zo={r:function(t,e){var n=t[e];return delete t[e],n},get:function(t,e){e=e.split(".");for(var n=0;n<e.length&&t;n++)t=t[e[n]];return t},keys:function(t){var e,n=[];for(e in t)n.push(e);return n},_baseSearch:function(t,e,n,r,o,a){o=o||"==";var i,s=za.compareTests(o);if("function"==typeof s){for(i in e)if(e[i]&&s(e[i].type,r,a)&&t(i))return}else if("special"==s)throw"zObject.findAll(): Search mode "+o+" is not implemented for objects."},findAll:function(t,e,n,r,o){var a={};return zo._baseSearch(function(t){a.push(t)},t,e,n,r,o),a},getAll:function(t,e,n,r,o){var a={};return zo._baseSearch(function(e){a[e]=t[e]},t,e,n,r,o),a},removeAll:function(t,e,n,r,o){var a={};return zo._baseSearch(function(e){a[e]=t[e],delete t[e]},t,e,n,r,o),a},extend:function(t,e,n){return $.extend(!n,t,e)},shyExtend:function(t,e){if("object"==typeof t&&"object"==typeof e){for(p in e)null==t[p]?t[p]=zo.clone(e[p]):zo.shyExtend(t[p],e[p]);return t}},clone:function(t,e){var n=za.isArray(t)?zo.extend([],t):"object"==typeof t?zo.extend({},t):t;return e&&(n=zo.extend(n,e)),n},isEmpty:function(t){return $.isEmptyObject(t)},equals:function(t,e,n){if(t===e)return!0;var r,o,a=zt.type(t);if(a!=zt.type(e))return!1;if("object"==a){for(o in t)if(!zo.equals(t[o],e[o]))return!1;return!0}if("array"==a){if(t.length!=e.length)return!1;if(n){for(r=0;r<t.length;r++)if(!zo.equals(t[r],e[r],!0))return!1;return!0}return 0==za.subtract(t,e).length}return"function"==a?zt.asString(t)==zt.asString(e):"number"==a?d3.round(t,10)==d3.round(e,10):!1},parseStyle:function(t,e){var n,r,o=t.base,a={};if(e=e||t,o){if("object"==typeof o)a=zo.clone(o,t);else if("string"==typeof o){for(o=o.split(" "),n=0;n<o.length;n++)zo.extend(a,zo.get(e,o[n]));zo.extend(a,t)}}else a=t;for(r in a)a[r]&&"object"==typeof a[r]&&(a[r]=zo.parseStyle(a[r],e));return delete t.base,a},initOrders:function(t,e){return e&&(t=zo.extend(e,t)),t.base&&(t=zo.extend(zo.r(t,"base"),t)),t.extend&&(t=zo.extend(t,zo.r(t,"extend"))),t},round:function(t,e){var n,r={};for(n in t)r[n]=d3.round(t[n],e);return r},add:function(t,e){var n,r={};for(n in t)r[n]=(t[n]||0)+(e[n]||0);return r},subtract:function(t,e){var n,r={};for(n in t)r[n]=(t[n]||0)-(e[n]||0);return r},mid:function(t,e,n){if(0==n||null==e||t==e)return t;if(1==n||null==t)return e;var r=zt.type(t);if(r!=zt.type(e))return e;if(zt.isColour(t))return zt.getColour(n,t,e);if("object"==r){var o,a={};for(o in e)a[o]=zo.mid(t[o],e[o],n);return a}if("array"==r){var i,a=[];for(i=0;i<e.length;i++)a[i]=zo.mid(t[i],e[i],n);return a}return"number"==r?zt.calcMid(t,e,n):e},midStack:function(t){return zt.calcMid(t.start,t.end)}},zTools=zt={type:function(t){return $.type(t)},isColour:function(t){if(t){if(null!=t.r&&null!=t.g&&null!=t.b)return!0;if("#"==t[0]&&(4==t.length||7==t.length))return!0}return!1},getColour:function(t,e,n,r){if(0==t||!r&&0>t)return e;if(1==t)return n;if(-1==t&&r)return r;var o=e,a=r&&0>t?r:n;return t=Math.min(Math.abs(t),1),d3.interpolate(o,a)(t)},getPalette:function(t,e,n){return za.getRandom(t||["#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462","#B3DE69","#FCCDE5","#D9D9D9","#BC80BD","#CCEBC5","#FFED6F"],e,n)},asString:function(t){var e=zt.type(t);if(null==t)return null;if("object"==e){var n,r=[];for(n in t)r.push(n+":"+zt.asString(t[n]));return"{"+r.join(",")+"}"}if("array"==e){var o,r=[];for(o=0;o<t.length;o++)r.push(zt.asString(t[o]));return"["+r.join(",")+"]"}return"string"==e?'"'+t+'"':t+""},camelCase:function(t){var e,n=""+t[0];for(e=1;e<t.length;e++)n+=t[e].substr(0,1).toUpperCase()+t[e].substr(1);return n},shorten:function(t,e){return null==t?"":t.length<=e?t:t.substr(0,e)+".."},wrap:function(t,e){if(null==t||"string"!=typeof t)return t;var n,r,o,a="",i="",s=t.split(" ");for(n=0;n<s.length;n++)for(o=s[n].split("\n"),r=0;r<o.length;r++)""==i?i=o[r]:i.length+o[r].length<e?i+=" "+o[r]:(a+=i+"\n",i=o[r]),r<o.length-1&&(a+=(i||" ")+"\n",i="");return a+i},format:function(t){return function(e){return zt._format(e,t)}},_format:function(t,e){if(za.isArray(t)){var n,r=[];for(n=0;n<t.length;n++)r.push(zt.format(t[n],e));return r}var o=function(t){var e,n=t.split(".");for(e=n[0].length-3;e>0;e-=3)n[0]=n[0].slice(0,e)+","+n[0].slice(e);if(n[1])for(e=3;e<n[1].length;e+=4)n[1]=n[1].slice(0,e)+","+n[1].slice(e);return n.join(".")},a=function(t){return isNaN(t)&&(t=0),[Math.floor(t/60),Math.round(t%60)]};e=e||{},"string"==typeof e&&(e={mode:e}),e.m&&(e.mode=e.m);var i,s="",l=Math.abs(t*(e.multiply||1));if(i=e.noSign?"":e.wordSign?t>0?"up ":0>t?"down ":"":e.forceSign?t>0?"+":0>t?"-":"":t>=0||e.noSign?"":"-",e.prefix&&(i+=e.prefix),"time"==e.mode){var u=a(l);return u[1]<10&&(u[1]="0"+u[1]),i+u.join(":")}if("hours"==e.mode){var u=a(l);return u[0]&&(u[0]+="hr"),u[1]&&(u[1]+="min"),i+u.join(" ")}if("hoursLong"==e.mode){var u=a(l);return u[0]&&(u[0]+=1==u[0]?" hour":" hours"),u[1]&&(u[1]+=1==u[1]?" minute":" minutes"),i+u.join(" ")}if("%"==e.mode)s="%",l*=100;else if("th"==e.mode){l=Math.round(l);var d=za.last(l),c=l[l.length-2];s=1==c?"th":1==d?"st":2==d?"nd":3==d?"rd":"th"}else if("abbreviate"==e.mode&&!zt.isBetween(l,-1e3,1e3)){var f=["","k","M","B","T"],p=3*Math.floor(zt.magnitude(l)/3);l/=Math.pow(10,p),s=f[p/3]}return l=zt.round(l,null==e.dp?10:e.dp),e.noCommas||(l=o(l+"")),i+l+s+(e.suffix||"")},round:function(t,e,n){var r="ceil"==n?Math.ceil:"floor"==n?Math.floor:Math.round;if(!e)return r(t);var o=Math.pow(10,Math.abs(e));return e>=0?r(t*o)/o:r(t/o)*o},isBetween:function(t,e,n,r){var o=Math.min(e,n),a=Math.max(e,n);return r?t>o&&a>t:t>=o&&a>=t},forceBetween:function(t,e,n){return Math.max(e,Math.min(n,t))},calcDec:function(t,e,n){return e==n?0:(t-e)/(n-e)},calcMid:function(t,e,n){return null==n&&(n=.5),t+(e-t)*n},scale:function(t,e,n,r,o){var a=zt.calcDec(t,e,n);return zt.calcMid(r,o,a)},factorial:function(t){for(var e=1,n=t;n>0;n--)e*=n;return e},magnitude:function(t){return t?(t=Math.abs(t),t>=1?(Math.round(t)+"").length-1:-za.find((t+"").split(".")[1],0,"!=")-1):0},getFactorOfTen:function(t,e){if(!t||isNaN(t)||1/0==Math.abs(t))return 0;var n=[1,2,2.5,5,10],r=0>t?-1:1,o=r*Math.pow(10,zt.magnitude(t)),a=t/o,i=e?za.getLast(n,a,"<="):za.get(n,a,">=");return o*i},getClosestFactorOfTen:function(t){return za.closest([zt.getFactorOfTen(t),zt.getFactorOfTen(t,!0)],t)},getMaxLayout:function(t,e,n,r){var o=$(r||"#chewy");return new zLayout({width:Math.max(t,$(window).width()-o.offset().left-8),height:Math.max(e,$(window).height()-o.offset().top-12),padding:n})},attach:function(t,e,n){if(e._canvas.nofo&&t.$.is("div")&&!e.$.is("div")&&(e=e._canvas.parent),null!=n){t.el.layer=n;var r,o=e.$.children();for(r=0;r<o.length;r++)if(o[r].layer>t.el.layer)return void e.d3.insert(function(){return t.el},function(){return o[r]})}e.d3.append(function(){return t.el})}};zLayout.prototype.set=function(t){var e,n=this;if(zo.isEmpty(t))return n;if(n=zo.extend(n,t instanceof zLayout?t.getVitals():t),t.anchor?(n.x=n.anchor.x,n.y=n.anchor.y):(null!=t.x&&(n.anchor.x=n.x),null!=t.y&&(n.anchor.y=n.y)),e=2*n.padding,n.autoWidth&&n.parent&&n.parent.bBox?(n.innerWidth=n.parent.bBox.width||0,n.width=n.innerWidth+e):null==t.width?(n.innerWidth=n.innerWidth||0,n.width=n.innerWidth+e):(n.innerWidth=n.width-e,isNaN(n.innerWidth)&&(n.innerWidth=0,n.width=e)),isNaN(n.width))throw"zLayout.set(): Invalid width.";if(n.autoHeight&&n.parent&&n.parent.bBox?(n.innerHeight=n.parent.bBox.height||0,n.height=n.innerHeight+e):null==t.height?(n.innerHeight=n.innerHeight||0,n.height=n.innerHeight+e):(n.innerHeight=n.height-e,isNaN(n.innerHeight)&&(n.innerHeight=0,n.height=e)),isNaN(n.height))throw"zLayout.set(): Invalid height.";if(n.align&&(e=n.align.substr(0,3),n.xAlign="cen"==e?"xCentre":"rig"==e?"right":"lef"==e?"left":logger("zLayout.set(): ERROR - align '"+n.align+"' is invalid."),e=n.align.substr(n.align.length-3,3),n.yAlign="tre"==e||"ter"==e?"yCentre":"tom"==e?"bottom":"Top"==e?"top":logger("zLayout.set(): ERROR - align '"+n.align+"' is invalid.")),null==n.radial)n.xAlign=n.xAlign||"left",n.yAlign=n.yAlign||"top",n.trueAnchor=n.anchor;else{var r=zp.matchDeg(n.radial);n.xAlign=n.xAlign||"xCentre",n.yAlign=n.yAlign||"yCentre",n.radialStartPoint=null!=n.radialStart?zp.addVector(r,n.radialStart,n.anchor):n.anchor,n.radialEndPoint=null!=n.radialEnd?zp.addVector(r,n.radialEnd,n.anchor):n.radialStartPoint,n.trueAnchor=zo.add(45>r?{x:.5*n.width,y:.5*n.height*zt.calcDec(r,0,45)}:135>r?{x:.5*n.width*zt.calcDec(r,90,45),y:.5*n.height}:225>r?{x:-.5*n.width,y:.5*n.height*zt.calcDec(r,180,135)}:315>r?{x:.5*n.width*zt.calcDec(r,270,315),y:-.5*n.height}:{x:.5*n.width,y:-.5*n.height*zt.calcDec(r,360,315)},n.radialEndPoint)}return n.centre=n.getPoint(.5,.5),n.xCentre=n.centre.x,n.yCentre=n.centre.y,n.corners=n.getCorners(),zo.extend(n,zp.pointsToBox(n.corners)),n.changed=!0,n},zLayout.prototype.zoom=function(t,e){var n=this;n.prevLayout=n.getVitals(),t=zp.completeBox(t),e=zp.completeBox(e||n);var r,o,a={x:e.width/t.width,y:e.height/t.height};return a.x<a.y?(a=a.x,t.height=e.height/a,o=e.yAlign||t.yAlign||n.yAlign,t.top="top"==o?t.top:"bottom"==o?t.bottom-t.height:t.yCentre-t.height/2,t.bottom=t.top+t.height):a.y<a.x?(a=a.y,t.width=e.width/a,o=e.xAlign||t.xAlign||n.xAlign,t.left="left"==o?t.left:"right"==o?t.right-t.width:t.xCentre-t.width/2,t.right=t.left+t.width):a=a.x,r={x:(n[n.xAlign]-t[n.xAlign])/t.width,y:(n[n.yAlign]-t[n.yAlign])/t.height},n.set({x:e.x+e.width*r.x,y:e.y+e.height*r.y,width:n.width*a,height:n.height*a,padding:n.padding*a})},zLayout.prototype.unzoom=function(){var t=this;t.prevLayout&&(t.set(t.prevLayout),t.prevLayout=null)},zLayout.prototype.readOrders=function(t){t.L&&this.set(zo.r(t,"L")),t.layout&&this.set(zo.r(t,"layout"))},zLayout.prototype.clone=function(t){return new zLayout(this.getVitals(t))},zLayout.prototype.getVitals=function(t){var e,n=this,r={},o=["x","y","anchor","padding","width","height","xAlign","yAlign","left","right","top","bottom","rotate","radial","radialStart","radialEnd"];for(e=0;e<o.length;e++)null!=n[o[e]]&&(r[o[e]]=zo.clone(n[o[e]]));return t?zo.extend(r,t):r},zLayout.prototype.getCorners=function(t){var e=this;return[e.getPoint(0,0,t),e.getPoint(1,0,t),e.getPoint(1,1,t),e.getPoint(0,1,t)]},zLayout.prototype.getRawRect=function(){var t=this,e={centre:{}};return"left"==t.xAlign?(e.left=t.x,e.right=t.x+t.width):"right"==t.xAlign?(e.left=t.x-t.width,e.right=t.x):(e.left=t.x-t.width/2,e.right=t.x+t.width/2),e.centre.x=(e.left+e.right)/2,"top"==t.yAlign?(e.top=t.y,e.bottom=t.y+t.height):"bottom"==t.yAlign?(e.top=t.y-t.height,e.bottom=t.y):(e.top=t.y-t.height/2,e.bottom=t.y+t.height/2),e.centre.y=(e.top+e.bottom)/2,e},zLayout.prototype.getString=function(){var t=this;return t.left+","+t.top+","+t.width+","+t.height},zLayout.prototype.getMatrixFrom=function(t){var e=this,n=za.fill(0,6);return n[0]=e.width/t.width,n[3]=e.height/t.height,n[4]=e.anchor.x-t.anchor.x*n[0],n[5]=e.anchor.y-t.anchor.y*n[3],"matrix("+n.join(",")+")"},zLayout.prototype.getMatrixTo=function(t){var e=this,n=za.fill(0,6);return n[0]=t.width/e.width,n[3]=t.height/e.height,n[4]=t.anchor.x-e.anchor.x*n[0],n[5]=t.anchor.y-e.anchor.y*n[3],"matrix("+n.join(",")+")"},zLayout.prototype.getSVG=function(t){var e=this;if(!t||!e.width||!e.height)return zp.shape(e.corners);var n=1;"right"==e.xAlign&&(n*=-1),"bottom"==e.yAlign&&(n*=-1),e.width<0&&(n*=-1),e.height<0&&(n*=-1);var r=zp.start,o=zp.lineTo,a=1==n?zp.arcTo:zp.reverseArcTo,i=t/Math.abs(e.width),s=t/Math.abs(e.height);return r(e.getPoint(i,0))+o(e.getPoint(1-i,0))+a(t,e.getPoint(1,s))+o(e.getPoint(1,1-s))+a(t,e.getPoint(1-i,1))+o(e.getPoint(i,1))+a(t,e.getPoint(0,1-s))+o(e.getPoint(0,s))+a(t,e.getPoint(i,0))},zLayout.prototype.getPoint=function(t,e,n){var r=this,o={x:r.getX(t,n),y:r.getY(e,n)};return r.rotate&&(o=r.getRadialPoint(o,r.rotate)),o},zLayout.prototype.getX=function(t,e){var n=this;return e?n.trueAnchor.x+("left"==n.xAlign?n.innerWidth*t+n.padding:"xCentre"==n.xAlign?n.innerWidth*(t-.5):n.innerWidth*-t-n.padding):n.trueAnchor.x+("left"==n.xAlign?n.width*t:"xCentre"==n.xAlign?n.width*(t-.5):n.width*-t)},zLayout.prototype.getY=function(t,e){var n=this;return e?n.trueAnchor.y+("top"==n.yAlign?n.innerHeight*t+n.padding:"yCentre"==n.yAlign?n.innerHeight*(t-.5):n.innerHeight*-t-n.padding):n.trueAnchor.y+("top"==n.yAlign?n.height*t:"yCentre"==n.yAlign?n.height*(t-.5):n.height*-t)},zLayout.prototype.getOffset=function(t,e,n){var r=this;return zo.subtract(r.getPoint(t,e,n),r.trueAnchor)},zLayout.prototype.getDec=function(t,e){var n=this;return n.rotate&&(t=n.getRadialPoint(t,-n.rotate)),e?{x:zt.calcDec(t.x,n.innerLeft,n.innerRight),y:zt.calcDec(t.y,n.innerTop,n.innerBottom)}:{x:zt.calcDec(t.x,n.left,n.right),y:zt.calcDec(t.y,n.top,n.bottom)}},zLayout.prototype.getRadialPoint=function(t,e){var n=this;if(!e)return t;var r=zp.vector(n.trueAnchor,t);return zp.addVector(r.deg+e,r.dist,n.trueAnchor)},zLayout.prototype.getPoints=function(t,e){var n,r=this,o=[];for(n=0;n<t.length;n++)o.push(r.getPoint(t[n][0],t[n][1],e));return o},zDrone.prototype._parseLayout=function(t,e){var n=zo.r(t,"layout")||zo.r(t,"L")||this.L;if(n)return n=n instanceof zLayout?n:new zLayout(n,this),n.changed=!0,n;if(e)throw console.log(t),"zDrone.add(): This part requires a layout, but no layout defined at the drone- or part-level."},zDrone.prototype._complexPlot=function(t,e){for(var n in e.parts)t[n]&&(t[n]=e.parts[n].plot(t[n],e));return t},zDrone.prototype._complexParse=function(t){var e,n=this,r={};for(e in n.parts)r[e]=zo.r(t,e)||{};for(e in n.parts)r[e]=zo.clone(t,r[e]);return zo.extend(t,r)},zDrone.prototype._parseOrders=function(t){var e=this,n=zo.r(t,e.isSimple);return n?zo.extend(t,n):t},zDrone.prototype._initPart=function(t){var e,n=this,r=n._presetParts[t.type],o=zo.r(t,"plot")||r.plot;if(make=zo.r(t,"make")||r.make,!make)throw"zDrone.add(): "+type+" is not a valid part type.";return e=make(t,n),o&&(e.plot=o),e},zDrone.prototype._makePart=function(t,e){this._canvas.nofo&&"zHTML"==e.type&&(t="div");var n,r=this,o=r.parent.roles,a="div"==t?"http://www.w3.org/1999/xhtml":"http://www.w3.org/2000/svg",l=document.createElementNS(a,t);if(layer=zo.r(e,"layer"),id=zo.r(e,"id"),role=zo.r(e,"role"),type=zo.r(e,"type"),objClass=zo.r(e,"objClass"),s=zo.r(e,"s"),P={el:l,$:$(l),d3:d3.select(l)},r.el?n=r:o&&o[role]?(n=o[role],type=null):n=r.parent,zt.attach(P,n,layer),id&&P.d3.attr("id",id),type&&P.d3.classed(type,!0),objClass)if(objClass instanceof Array)for(i=0;i<objClass.length;i++)P.d3.classed(objClass[i],!0);else P.d3.classed(objClass,!0);return P},zDrone.prototype.add=function(t,e,n){if(t){t=zo.initOrders(t);var r,o,a,i=this;if(i.parent=zo.r(t,"parent")||i._canvas,i.L=i._parseLayout(t),i.parts=zo.getAll(t,"type",null,"!="),r=zo.keys(i.parts),1==r.length)i.isSimple=a=r[0],o=i._parseOrders(t),i.parts[a]=i._initPart(o),zo.extend(i,i.parts[a]);else{i.isSimple=!1,i._transition=i._complexTransition,i._parseOrders=i._complexParse,i.plot=i._complexPlot,zo.extend(i,i._makePart("g",t)),t=i._parseOrders(t);for(a in i.parts)o=t[a],o.id=a,i.parts[a]=i._initPart(o)}i.attr(t),i.d3.style("transition"),i.appear(e,n),i.L&&(i.L.changed=!1)}},zDrone.prototype.remove=function(t,e){var n=this;n.hide(t,function(){n.parent.drones&&za.remove(n.parent.drones,n),e&&e()})},zDrone.prototype.attach=function(t){var e=this,n=e.parent.roles,r=n&&n[e.role]?n[e.role]:e.parent;zt.attach(e,r,t)},zDrone.prototype.toFront=function(){var t=this,e=t.parent.roles,n=e&&e[t.role]?e[t.role]:t.parent;n.d3.append(function(){return t.el})},zDrone.prototype.show=function(t,e){var n,r,o,a=this;if(a._hidden&&(a._hidden=!1,a.attach(a.el.layer),a.eventListeners)){for(r in a.eventListeners)for(o=a.eventListeners[r],n=0;n<o.length;n++)a.$.on(r,o[n].handler);delete a.eventListeners}a._fixClass(),a.removeClass("_hide",t,e)},zDrone.prototype.hide=function(t,e){var n=this;n.addClass("_hide",t,function(){n._hidden||(n.eventListeners=zo.clone($._data(n.d3.node(),"events"))),n._hidden=!0,$(n.el).remove(),e&&e()})},zDrone.prototype.appear=function(t,e){t&&(this._fixClass(),this.addClass("_hide",0),this.removeClass("_hide",t,e))},zDrone.prototype._fixClass=function(){this.addClass("placeholder"),this.removeClass("placeholder")},zDrone.prototype._setClass=function(t,e,n,r){var o=this,a=o.d3;if(!t||a.classed(t)==e)return void(r&&r());"number"==typeof n&&(n={t:n}),a.classed(t,e),n&&(a.style("transition-property","all"),a.style("transition-duration",n.t+"ms"),a.style("transition-timing-function",n.e||"ease-in-out"),a.style("transition-delay",(n.delay||0)+"ms"),a.style("transition"));var i=a.style("transition-property"),s=a.style("transition-duration"),l=a.style("transition-delay");0==n||!s&&!l||"0s"==s&&"0s"==l?r&&r():"all"!=i&&null==a.style(i)?(console.log("zDrone._classed(): This CSS transition doesn't look right: ["+a.style("transition")+"]."),r&&r()):a.on("transitionend",function(){a.on("transitionend",""),n&&a.style("transition",""),r&&r()})},zDrone.prototype.addClass=function(t,e,n){this._setClass(t,!0,e,n)},zDrone.prototype.removeClass=function(t,e,n){this._setClass(t,!1,e,n)},zDrone.prototype._makeTransition=function(t,e){return"__transition__"==t.namespace?t:this.d3.transition().duration(t.t).ease(t.e||"cubic-in-out").each("end",e)},zDrone.prototype._transition=function(t,e,n,r){var o=this;"number"==typeof n&&(n={t:n}),n&&n.t?e&&o._makeTransition(n,r)[t](e):(e&&o.d3[t](e),r&&r())},zDrone.prototype._complexTransition=function(t,e,n,r){var o,a,i,s,l=this;if("number"==typeof n&&(n={t:n}),n&&n.t){if(s=l._makeTransition(n,r),e){for(a in l.parts)i=l.parts[a],o=zo.r(e,a),o&&s.select(function(){return i.el})[t](o);s[t](e)}}else{if(e){for(a in l.parts)i=l.parts[a],o=zo.r(e,a),o&&i.d3[t](o);l.d3[t](e)}r&&r()}},zDrone.prototype.style=function(t,e,n){this._transition("style",t,e,n)},zDrone.prototype.attr=function(t,e,n){var r=this;r.L&&r.L.readOrders(t),t=r._parseOrders(t),t=r.plot(t,r),r._transition("attr",t,e,n),r.L&&(r.L.changed=!1)},zDrone.prototype.mouseEventsOff=function(){this.d3.style("pointer-events","none")},zDrone.prototype.mouseEventsOn=function(){this.d3.style("pointer-events",null)},zDrone.prototype.clearMouseEvents=function(t){this.$.unbind(t)},zDrone.prototype.getEventPos=function(t){var e=this._canvas.$.offset();return{x:t.pageX-e.left,y:t.pageY-e.top}},zDrone.prototype.click=function(t){this.d3.classed("_clickable",!0),this.$.click(t)},zDrone.prototype.dblclick=function(t){this.$.dblclick(t)},zDrone.prototype.mousedown=function(t){this.$.mousedown(t)},zDrone.prototype.mouseup=function(t){this.$.mouseup(t)},zDrone.prototype.mousemove=function(t){this.$.mousemove(t)},zDrone.prototype.mouseover=function(t){this.$.mouseover(t)},zDrone.prototype.mouseout=function(t){this.$.mouseout(t)},zDrone.prototype.hover=function(t,e){this.$.mouseover(t),this.$.mouseout(e)},zDrone.prototype.drag=function(t,e,n){var r=this;$(window).mousemove(function(){r._isDragging&&t&&t()}),r.mousedown(function(){r._isDragging=!0,e&&e()}),$(window).mouseup(function(){r._isDragging=!1,n&&n()})},zDrone.prototype.hoverHighlight=function(t){var e=this;e.hover(function(){e.addClass("highlight",t)},function(){e.removeClass("highlight",t)})},zDrone.prototype.showAt=function(t,e,n){var r,o=this;o.show(0),zo.isEmpty(t)||(r=o.getEventPos(t),e=zo.extend({x:Math.max(r.x-8,o.L.width),y:Math.max(r.y-8,o.L.height)},e)),o.attr({layout:e},n)},zDrone.prototype.tooltip=function(t,e,n){var r=this;r.mousemove(function(t){e.showAt(t,n)}),r.hover(function(o){e.attr({text:t||r.tooltipText}),e.showAt(o,n,100)},function(){e.hide(100)})},zDrone.prototype._presetParts={arc:{plot:function(t){var e,n=this,r=!1;for(e in n.arc)null!=t[e]&&(n.arc[e]=zo.r(t,e),r=!0);return r&&(t.d=zp.arc(n.arc)),t},make:function(t,e){var n=e._makePart("path",t);return n.arc={minSeg:null,centre:null,degStart:null,degEnd:null,innerRadius:null,outerRadius:null},n}},line:{plot:function(t){return t.points&&(t.d=zp.line(zo.r(t,"points"))),t},make:function(t,e){return e._makePart("path",t)}},shape:{plot:function(t){return t.points&&(t.d=zp.shape(zo.r(t,"points"))),t},make:function(t,e){return e._makePart("path",t)}},circle:{plot:function(t){return t.centre&&(t.cx=t.centre.x,t.cy=t.centre.y,delete t.centre),null!=t.radius&&(t.r=zo.r(t,"radius")),t.cx&&(t.cx=Math.round(t.cx)),t.cy&&(t.cy=Math.round(t.cy)),t.r&&(t.r=Math.round(t.r)),t},make:function(t,e){return e._makePart("circle",t)}},directRect:{plot:function(t){return t},make:function(t,e){return e._makePart("rect",t)}},rect:{plot:function(t,e){var n=this;return n.L.set(t.L||t.layout),n.L.changed&&(t.d=n.L.getSVG(n.L.rounded),n.L!=e.L&&(n.L.changed=!1)),t},make:function(t,e){if(!e.L&&!t.L&&!t.layout){var n=e._presetParts.directRect;return n.make(t,e)}var r=e._makePart("path",t);return r.L=e._parseLayout(t,!0),r}},text:{plot:function(t,e){"string"==typeof t&&(t={text:t});var n,r,o,a=this,i=!1;a.L.readOrders(t);for(n in a.O)if(null!=t[n]){i=!0;break}if(i){if("string"==typeof t.format)t.format=d3.format(t.format);else if(t.format&&!(t.format instanceof d3.format))throw zt.asString(t.format)+" is not a valid format type.";za.forEach(["textXAlign","textYAlign","format","text"],function(e){null!=t[e]&&(a.O[e]=zo.r(t,e))}),a.d3.text(a.O.format?a.O.format(a.O.text):a.O.text),a.d3.attr({fontSize:t.fontSize,fontWeight:t.fontWeight}),a.bBox=a.el.getBBox(),a.d3.attr({fontSize:a.O.fontSize,fontWeight:a.O.fontWeight}),za.forEach(["font-size","fontWeight"],function(e){t[e]&&(a.O[e]=t[e])});var s={};a.L.autoWidth&&(s.innerWidth=a.bBox.width),a.L.autoHeight&&(s.innerHeight=a.bBox.height),a.L.set(s)}return a.L.changed&&(r={x:a.bBox.width/2/(a.L.innerWidth||1),y:a.bBox.height/2/(a.L.innerHeight||1)},o=a.L.getPoint("xCentre"==a.O.textXAlign?.5:"left"==a.O.textXAlign?"right"==a.L.xAlign?1-r.x:r.x:"right"==a.L.xAlign?r.x:1-r.x,"yCentre"==a.O.textYAlign?.5:"yCentre"==a.L.yAlign?"top"==a.O.textYAlign?r.y:1-r.y:a.O.textYAlign==a.L.yAlign?r.y:1-r.y,!0),t.x=Math.round(o.x),t.y=Math.round(o.y),a.L.rotate&&(t.transform="rotate("+a.L.rotate+" "+o.x+","+o.y+")"),a.L!=e.L&&(a.L.changed=!1)),t},make:function(t,e){var n=e._makePart("text",t);return n.L=e._parseLayout(t,!0),n.O={text:null,format:null,"font-size":null,fontWeight:null,textXAlign:null,textYAlign:null},n.bBox={width:0,height:0},t.textXAlign=t.textXAlign||n.L.xAlign,t.textYAlign=t.textYAlign||n.L.yAlign,t["text-anchor"]&&console.log("zDrone.add(): HEY - Part type 'text' uses zLayout for automatic placement and does not accept 'text-anchor'. Use 'textXAlign' = 'left'/'right'/'centre' instead."),t["alignment-baseline"]&&console.log("zDrone.add(): HEY - Part type 'text' uses zLayout for automatic placement and does not accept 'alignment-baseline'. Use 'textYAlign' = 'top'/'bottom'/'centre' instead."),n.d3.attr({"text-anchor":"middle","alignment-baseline":"middle"}),n}},branch:{plot:function(t,e){return e.L.changed&&(t.d=zp.line([e.L.radialStartPoint,e.L.radialEndPoint])),t},make:function(t,e){return e._presetParts.line.make(t,e)}},axisTitle:{make:function(t,e){var n,r=e.align,o=e.L,a=o.padding-t.titlePadding,i={x:o.centre.x,y:o.centre.y,rotate:0,align:"centre"};return"left"==r?(i.x=o.left+a,i.rotate=-90):"right"==r?(i.x=o.right-a,i.rotate=90):i.y="top"==r?o.top+a:o.bottom-a,t.layout=zo.extend(i,t.layout),n=e._presetParts.text.make(t,e),n.plot=e._presetParts.text.plot,n}},axisTicks:{plot:function(t,e){var n=e.L,r="ver"==e.mode?[n.getY(0,!0),n.getY(1,!0)]:[n.getX(0,!0),n.getX(1,!0)];return e.dc?(e.scale.domain(e.dc.domain[e.d]).rangePoints(r,e.extension),t.ticks&&(e.ticks=t.ticks),e.filterTicks(e.ticks),e.axis.tickFormat(function(t){return e.dc.getName({d:e.d,p:t})})):(t.domain&&e.scale.domain(t.domain).nice(),e.scale.range(r)),n.changed&&(t.transform="translate("+("left"==e.align?n.left+n.padding+",0":"right"==e.align?n.right-n.padding+",0":"top"==e.align?"0,"+(n.top+n.padding):"0,"+(n.bottom-n.padding))+")"),e.axis.scale(e.scale),"string"==typeof t.tickFormat&&(t.tickFormat=d3.format(t.tickFormat)),za.forEach(["ticks","tickFormat","innerTickSize","outerTickSize","tickPadding"],function(n){null!=t[n]&&e.axis[n](zo.r(t,n))}),e.axis(this.d3),t},make:function(t,e){var n,r=e.align=zo.r(t,"align"),o=e.mode="left"==r||"right"==r?"ver":"top"==r||"bottom"==r?"hor":null;if(!o)throw"Axis goes around the inner edge of a layout. orders.align must be defined. Only left/right/top/bottom are valid alignments. orders.align is currently ["+r+"].";return t.dc?(e.dc=zo.r(t,"dc"),e.d=zo.r(t,"d"),e.extension=zo.r(t,"extension"),null==e.extension&&(e.extension=1),e.scale=d3.scale.ordinal()):e.scale=d3.scale.linear(),e.axis=d3.svg.axis().orient(r),e.directRedraw=!0,n=e._makePart("g",t),n.plot=e._presetParts.axisTicks.plot,n}}};var zAxis=function(t,e,n){if(t=zo.initOrders(t,{type:"zAxis",align:"left",ticks:5,tickPadding:5,extension:1,ticksObj:{type:"axisTicks"}}),t.title){var r=zo.extend({type:"axisTitle",text:t.title,titlePadding:50},t.titleObj);delete t.titleObj,t.titleObj=r}var o=zo.extend(new zDrone,{dc:t.dc,d:t.d,baseSelected:t.baseSelected,selected:t.selected,swarms:t.swarms,axisSelect:function(t,e,n){var r,o=this,a=o.dc.domain[o.d];if(t=zt.forceBetween(t,za.min(a),za.max(a)),o.selected!=t){for(o.selected=t,o.attr({placeholder:!0},e,n),r=0;r<o.swarms.length;r++)o.swarms[r].setSpace({d:o.d,p:t}),o.swarms[r].refresh("all",e);o.onSelect&&o.onSelect(e)}},axisMove:function(t,e,n){var r=this,o=t>r.selected?1:-1;t!=r.selected?r.axisSelect(r.selected+o,e,function(){r.axisMove(t,e,n)}):n&&n()},filterTicks:function(t){var e=o.scale.domain(),n=Math.ceil(e.length/t),r=Math.floor((e.length-1)%n/2);o.axis.tickValues(e.filter(function(t){return!((t-r)%n)}))},setDomain:function(t,e){e=e||0,"number"==typeof e&&(e={t:e}),o.scale.domain(t),o.dc?(o.dc.domain[o.d]=t,o.filterTicks(o.ticks)):o.scale.nice(),o.parts.ticksObj.d3.transition().duration(e.t||0).ease(e.e||"cubic-in-out").call(o.axis)}});return o.add(t,e,n),o},zSlideAxis=function(t,e,n){t=zo.extend({type:"zSlideAxis",d:0,swarms:[],baseSelected:0,selected:0,extension:0},t),t.background={type:"rect"},t.foreground={type:"rect",layout:{},plot:function(t,e){var n,r=this,o=null!=e.selected.p?e.selected.p:e.selected||0;return e.L&&(n=e.L.getPoint(0,0,!0),r.L.set("hor"==e.mode?{anchor:n,height:e.L.innerHeight,width:e.scale(o)-n.x}:{anchor:n,width:e.L.innerWidth,height:e.scale(o)-n.y}),t.d=r.L.getSVG(e.L.rounded)),t}};var r=new zAxis(t,e,n);return r.click(function(t){var e=r.getEventPos(t),n="hor"==r.mode?"x":"y",o=r.scale.range(),a=r.scale.domain(),i=za.find(o,e[n],"closest");r.axisMove(a[i],{t:300,e:"linear"})}),r};zSwarm.prototype.forDrones=function(t,e,n,r,o,a,i,s){var l,u=this,d=u.get(t);if(d)if("string"==typeof e)for(l=d.length-1;l>=0;l--)d[l][e]&&d[l][e](n,r,o,a,i,s);else if("function"==typeof e)for(l=d.length-1;l>=0;l--)e(d[l])},zSwarm.prototype.forRoles=function(t){var e,n,r=this;for(e in r.P)n=r.P[e],n&&!n.ignore&&t(n)},zSwarm.prototype.getRole=function(t){var e,n,r=["","all","mask","fixed"];if(null==t||za.contains(r,t))return null;if(e=t.role||t,"string"!=typeof e)return null;if(n=this.P[e],!n)throw"zSwarm.getRole(): Cannot find role type "+e+".";return n},zSwarm.prototype.addDimension=function(t){return null!=t&&null==t.d&&(null!=t.a||null!=t.r||t.s||t.rs)&&(t.d=this.d),t},zSwarm.prototype.asPos=function(t){return this.dc.asPos(this.addDimension(t))},zSwarm.prototype.asSpace=function(t){return this.dc.asSpace(this.addDimension(t))
},zSwarm.prototype.setSpace=function(t){var e=this,n=null==t.d?e.d:t.d,r=e.asPos(t);return null==r?logger(e.type+".setSpace(): No pos specified ("+zt.asString(t)+")."):"fixed"==e.s?logger(e.type+".setSpace(): Can't change "+zt.asString(e.s)+" to "+zt.asString(r)+"."):void(typeof e.s[n]==typeof r&&(e.s[n]=zo.clone(r),e.forRoles(function(t){t.mask.s&&"mask"==t.mask.s[n]&&e.forDrones(t.name,function(t){t.s[n]=zo.clone(r)})})))},zSwarm.prototype.get=function(t){var e=this;if(za.isArray(t))return t;if("swarm"==t)return[e.container];if(null==t||"all"==t)return e.drones;if("curr"==t||t.curr)return e.currDrones;if("fixed"==t)return za.getAllObjects(e.drones,"A","fixed");if("string"==typeof t)return za.getAllObjects(e.drones,"role",t);if(t.role&&null==t.d&&null==t.s)return za.getAllObjects(e.drones,"role",t.role);var n,r,o,a=e.dc.parseSpace(e.addDimension(t)).s,i=e.asSpace(t),s=t.role?za.getAllObjects(e.drones,"role",t.role):e.drones;for(n=0;n<i.length&&0!=s.length;n++)if("number"==typeof i[n])s=za.getAllObjects(s,"s",i[n],"atPos",n);else if(za.isArray(i[n])&&"all"!=a[n]){for(o=[],r=0;r<s.length;r++)za.contains(i[n],s[r].s[n])&&o.push(s[r]);s=o}return s},zSwarm.prototype.setCurrDrones=function(t){return this.currDrones=this.get(t)},zSwarm.prototype._addDrone=function(t,e,n,r){var o,a,i,s=this,l=s.P[t],u={id:zt.asString(e)+" "+t,role:t,s:e,O:{},Y:zo.clone(s.Y[t]||{})},o="function"==typeof l.curr?l.curr(s,u,n):l.curr,d="function"==typeof l.init?l.init(s,u,n):l.init;if(za.getObject(s.drones,"id",u.id))return logger(s.type+".addDrone(): Uh oh - A "+t+" at "+zt.asString(e)+" already exists.");if(u.currOrders=o||{},a={id:e,type:l.type,parent:s,role:t},a=zo.extend(a,s.Y[t]),a=zo.extend(a,zo.clone(u.currOrders)),a=zo.extend(a,d||{}),!a.ignore){if("function"==typeof a.type)i=new a.type(a,r);else{if(!s._presetDrones[a.type])throw"zSwarm.addDrone(): "+a.type+" is not a valid drone type.";i=new s._presetDrones[a.type](a,r)}return u=zo.extend(i,u),l.directRedraw&&(u.directRedraw=!0),l.onAdd&&l.onAdd(s,u,n),s.drones.push(u),u}},zSwarm.prototype.add=function(t,e,n){var r,o,a,i,s=this,l=[],u=[],d=s.getRole(t),c=zo.extend({initialising:!0},t.mode),f=s.dc.addSpaces(s.s,"string"==typeof t?null:s.asSpace(t));for(c.initialising=!0,d?(d.ignore=!1,l=[d]):s.forRoles("fixed"==t?function(t){"fixed"==t.mask&&l.push(t)}:function(t){"fixed"!=t.mask&&l.push(t)}),r=0;r<l.length;r++)if(d=l[r],"fixed"==d.mask)i=s._addDrone(d.name,"fixed",c),i&&u.push(i);else for(a=s.dc.listSpaces({s:f,mask:d.mask}),o=0;o<a.length;o++)i=s._addDrone(d.name,a[o],c),i&&u.push(i);e?s.appear(u,e,n):n&&n()},zSwarm.prototype.remove=function(t,e,n){var r=this,o=r.getRole(t);o&&(o.ignore=!0),r.forDrones(t,"remove",e),n&&r.G.delay(e,n)},zSwarm.prototype.show=function(t,e,n){this.forDrones(t,"show",e),n&&this.G.delay(e,n)},zSwarm.prototype.hide=function(t,e,n){this.forDrones(t,"hide",e),n&&this.G.delay(e,n)},zSwarm.prototype.appear=function(t,e,n){this.forDrones(t,"appear",e),n&&this.G.delay(e,n)},zSwarm.prototype.lock=function(){this.locked=$.now(),this.container.mouseEventsOff()},zSwarm.prototype.unlock=function(){this.locked=null,this.container.mouseEventsOn()},zSwarm.prototype.plot=function(t,e){var n,r,o=this,a=o.get(t),i=t&&t.mode?t.mode:{};for(n=0;n<a.length;n++)r=a[n],r.oldOrders=r.currOrders,r.newOrders=o.P[r.role].curr?o.P[r.role].curr(o,r,i,r.s,o.Y[r.role]):{},za.forEach(["onAdd","preRedraw","postRedraw"],function(t){zo.r(r.newOrders,t)}),r.noChange=!e&&!(r.L&&r.L.changed)&&zo.equals(r.newOrders,r.oldOrders)},zSwarm.prototype.frameRedraw=function(t,e){var n=this;n.currDec=e,n.forDrones(t,function(t){t.noChange||(t.currOrders=zo.mid(t.oldOrders,t.newOrders,e),t.attr(zo.clone(t.currOrders)))}),n.frames++},zSwarm.prototype.refresh=function(t,e,n){var r,o,a=this,i=[],s=[],l=a.thread=$.now(),u=t&&t.mode?t.mode:{},d=a.setCurrDrones(t);for(a.currDec<1&&a.frameRedraw(d,a.currDec),!u.noUpdateData&&a.updateData&&a.updateData(e),a.plot({curr:!0,mode:u}),a.preRedraw(d),a.mouseEventsOff("all"),r=0;r<d.length;r++)o=d[r],o.noChange||o._hidden||(o.directRedraw?s.push(o):i.push(o));for(e?("number"==typeof e&&(e={t:e}),e.e=e.e||"cubic-in-out",a.G.redraw(function(){a.frameRedraw(i,a.G.dec)},e,function(){a.thread==l&&(a.frameRedraw(d,1),a.postRedraw(d),a.mouseEventsOn("all"),n&&n())})):(a.frameRedraw(d,1),a.postRedraw(d),a.mouseEventsOn("all"),n&&n()),r=0;r<s.length;r++)o=s[r],o.attr(o.newOrders,e)},zSwarm.prototype.addClass=function(t,e,n,r){this.forDrones(t,"addClass",e,n),r&&this.G.delay(n,r)},zSwarm.prototype.removeClass=function(t,e,n,r){this.forDrones(t,"removeClass",e,n),r&&this.G.delay(n,r)},zSwarm.prototype.mouseEventsOff=function(t){this.forDrones(t,"mouseEventsOff")},zSwarm.prototype.mouseEventsOn=function(t){this.forDrones(t,"mouseEventsOn")},zSwarm.prototype.clearMouseEvents=function(t){this.forDrones(t,"clearMouseEvents")},zSwarm.prototype.click=function(t,e){this.forDrones(t,"click",e)},zSwarm.prototype.dblclick=function(t,e){this.forDrones(t,"dblclick",e)},zSwarm.prototype.mousedown=function(t,e){this.forDrones(t,"mousedown",e)},zSwarm.prototype.mouseup=function(t,e){this.forDrones(t,"mouseup",e)},zSwarm.prototype.mousemove=function(t,e){this.forDrones(t,"mousemove",e)},zSwarm.prototype.mouseover=function(t,e){this.forDrones(t,"mouseover",e)},zSwarm.prototype.mouseout=function(t,e){this.forDrones(t,"mouseout",e)},zSwarm.prototype.hover=function(t,e,n){this.forDrones(t,"hover",e,n)},zSwarm.prototype.drag=function(t,e,n,r){this.forDrones(t,"drag",e,n,r)},zSwarm.prototype.hoverHighlight=function(t,e){this.forDrones(t,"hoverHighlight",e)},zSwarm.prototype.tooltip=function(t,e,n,r){this.forDrones(t,"tooltip",e,n,r)},zSwarm.prototype.preRedraw=function(){var t=this;t.forRoles(function(e){e.preRedraw&&t.forDrones(e.name,function(n){e.preRedraw(t,n)})})},zSwarm.prototype.postRedraw=function(){var t=this;t.forRoles(function(e){e.postRedraw&&t.forDrones(e.name,function(n){e.postRedraw(t,n)})})},zSwarm.prototype.zoom=function(t,e,n,r){this.L.zoom(t,e),this.refresh("all",n,r)},zSwarm.prototype.highlight=function(t,e,n){var r=this;r.removeClass("all","highlight",e,n),t?(r.highlighted=r.asPos(t),r.addClass({d:null==t.d?r.d:t.d,p:r.highlighted},"highlight",e)):r.highlighted=[]},zSwarm.prototype.select=function(t,e,n){var r=this;r.oldSelected=r.selected,r.selected={d:r.d,p:r.asPos(t)},r.removeClass(r.oldSelected,"select",e),r.addClass(r.selected,"select",e,n)},zSwarm.prototype.deselect=function(t,e,n){this.removeClass(t,"select",e,n)},zSwarm.prototype.disaggregate=function(t,e,n){null==t.d&&(t.d=this.d);var r=this,o=r.dc.domain,a=r.dc.asPos(t),i=r.dc.findChildren(t);i.length&&(o[t.d]=za.subtract(o[t.d],a),o[t.d]=za.insertAt(o[t.d],i,a),r.updateData(e),r.remove({d:t.d,p:a},e),r.add({d:t.d,p:i,mode:{asParent:!0}},e,n))},zSwarm.prototype.aggregate=function(t,e,n){null==t.d&&(t.d=r.d);var r=this,o=r.dc.domain,a=za.find(o,t.p),i=r.dc.findParent(t),s=r.dc.findChildren({d:t.d,p:i});null!=i&&(o[t.d]=za.subtract(o[t.d],s),o[t.d]=za.shyInsert(o[t.d],i,a),r.updateData(e),r.remove({d:t.d,p:s,mode:{asParent:!0}},e),r.add({d:t.d,p:i},e,n))},zSwarm.prototype._presetDrones={zDrone:zDrone,zComplex:zComplex,zLine:zLine,zShape:zShape,zArc:zArc,zCircle:zCircle,zRectangle:zRectangle,zText:zText,zHTML:zHTML,zTextBox:zTextBox,zTooltipBox:zTooltipBox,zHTMLTooltipBox:zHTMLTooltipBox,zAxis:zAxis,zGladwrap:zGladwrap};